steps:

  # Install node packages
  - name: node:lts
    entrypoint: npm
    args: [ 'install' ]
    dir: 'frontend'
    id: install
    waitFor: [ '-' ]

  # # Lint
  # - name: node:14.4.0
  #   entrypoint: npm
  #   args: [ 'run', 'lint' ]
  #   dir: 'frontend'
  #   id: lint
  #   waitFor:
  #     - install

  # # Build
  # - name: node:14.4.0
  #   entrypoint: npm
  #   args: [ 'run', 'build' ]
  #   dir: 'frontend'
  #   id: build
  #   waitFor: 
  #     - install

  # Install puppeteer dependencies
  - name: ubuntu:18.04
    args: 
      - 'apt'
      - 'install'
      - 'libgbm-dev'
    dir: 'frontend'
    id: install-test-dependencies
    waitFor:
      - install

  # Test with out need for a browser (headless)
  - name: node:lts
    entrypoint: npm
    args: [ 'run', 'test-headless']
    dir: 'frontend'
    id: test
    waitFor:
      - install-test-dependencies
